"use strict";(self.webpackChunk_202305_webworker_in_angular_cli_with_comlink=self.webpackChunk_202305_webworker_in_angular_cli_with_comlink||[]).push([[460],{7460:(R,f,c)=>{c.r(f),c.d(f,{default:()=>B});var _=c(5926),v=c(7746),k=c(3359),r=c(2223),p=c(4755),l=c(9401),y=c(1728),d=c(6012),W=c(9114),T=c(8097),g=c(533),m=c(4150),u=c(574),b=c(1217),h=c(1692);const M=["determinateSpinner"];function S(i,a){if(1&i&&(r.O4$(),r.TgZ(0,"svg",11),r._UZ(1,"circle",12),r.qZA()),2&i){const t=r.oxw();r.uIk("viewBox",t._viewBox()),r.xp6(1),r.Udp("stroke-dasharray",t._strokeCircumference(),"px")("stroke-dashoffset",t._strokeCircumference()/2,"px")("stroke-width",t._circleStrokeWidth(),"%"),r.uIk("r",t._circleRadius())}}const A=(0,b.pj)(class{constructor(i){this._elementRef=i}},"primary"),Z=new r.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function P(){return{diameter:w}}}),w=100;let O=(()=>{class i extends A{constructor(t,o,e){super(t),this.mode="mat-spinner"===this._elementRef.nativeElement.nodeName.toLowerCase()?"indeterminate":"determinate",this._value=0,this._diameter=w,this._noopAnimations="NoopAnimations"===o&&!!e&&!e._forceAnimations,e&&(e.color&&(this.color=this.defaultColor=e.color),e.diameter&&(this.diameter=e.diameter),e.strokeWidth&&(this.strokeWidth=e.strokeWidth))}get value(){return"determinate"===this.mode?this._value:0}set value(t){this._value=Math.max(0,Math.min(100,(0,h.su)(t)))}get diameter(){return this._diameter}set diameter(t){this._diameter=(0,h.su)(t)}get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(t){this._strokeWidth=(0,h.su)(t)}_circleRadius(){return(this.diameter-10)/2}_viewBox(){const t=2*this._circleRadius()+this.strokeWidth;return`0 0 ${t} ${t}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return"determinate"===this.mode?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}}return i.\u0275fac=function(t){return new(t||i)(r.Y36(r.SBq),r.Y36(r.QbO,8),r.Y36(Z))},i.\u0275cmp=r.Xpm({type:i,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(t,o){if(1&t&&r.Gf(M,5),2&t){let e;r.iGM(e=r.CRH())&&(o._determinateCircle=e.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:16,hostBindings:function(t,o){2&t&&(r.uIk("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow","determinate"===o.mode?o.value:null)("mode",o.mode),r.Udp("width",o.diameter,"px")("height",o.diameter,"px")("--mdc-circular-progress-size",o.diameter+"px")("--mdc-circular-progress-active-indicator-width",o.diameter+"px"),r.ekj("_mat-animation-noopable",o._noopAnimations)("mdc-circular-progress--indeterminate","indeterminate"===o.mode))},inputs:{color:"color",mode:"mode",value:"value",diameter:"diameter",strokeWidth:"strokeWidth"},exportAs:["matProgressSpinner"],features:[r.qOj],decls:14,vars:11,consts:[["circle",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["determinateSpinner",""],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(t,o){if(1&t&&(r.YNc(0,S,2,8,"ng-template",null,0,r.W1O),r.TgZ(2,"div",1,2),r.O4$(),r.TgZ(4,"svg",3),r._UZ(5,"circle",4),r.qZA()(),r.kcU(),r.TgZ(6,"div",5)(7,"div",6)(8,"div",7),r.GkF(9,8),r.qZA(),r.TgZ(10,"div",9),r.GkF(11,8),r.qZA(),r.TgZ(12,"div",10),r.GkF(13,8),r.qZA()()()),2&t){const e=r.MAs(1);r.xp6(4),r.uIk("viewBox",o._viewBox()),r.xp6(1),r.Udp("stroke-dasharray",o._strokeCircumference(),"px")("stroke-dashoffset",o._strokeDashOffset(),"px")("stroke-width",o._circleStrokeWidth(),"%"),r.uIk("r",o._circleRadius()),r.xp6(4),r.Q6J("ngTemplateOutlet",e),r.xp6(2),r.Q6J("ngTemplateOutlet",e),r.xp6(2),r.Q6J("ngTemplateOutlet",e)}},dependencies:[p.tP],styles:["@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-color-1-fade-in-out{from{opacity:.99}25%{opacity:.99}26%{opacity:0}89%{opacity:0}90%{opacity:.99}to{opacity:.99}}@keyframes mdc-circular-progress-color-2-fade-in-out{from{opacity:0}15%{opacity:0}25%{opacity:.99}50%{opacity:.99}51%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-3-fade-in-out{from{opacity:0}40%{opacity:0}50%{opacity:.99}75%{opacity:.99}76%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-4-fade-in-out{from{opacity:0}65%{opacity:0}75%{opacity:.99}90%{opacity:.99}to{opacity:0}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}.mdc-circular-progress{display:inline-flex;position:relative;direction:ltr;line-height:0;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-1{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-1-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-2{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-2-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-3{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-3-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-4{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-4-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--closed{opacity:0}.mat-mdc-progress-spinner{--mdc-circular-progress-active-indicator-width:4px;--mdc-circular-progress-size:48px}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-1 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-2 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-3 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-4 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner .mdc-circular-progress{width:var(--mdc-circular-progress-size) !important;height:var(--mdc-circular-progress-size) !important}.mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}"],encapsulation:2,changeDetection:0}),i})(),z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({imports:[p.ez,b.BQ]}),i})();var E=c(8567);function D(i,a){1&i&&r._UZ(0,"mat-progress-spinner",9)}const B=(()=>{var i=new WeakMap,a=new WeakMap;class t{constructor(){(0,_.Z)(this,i,{writable:!0,value:void 0}),(0,_.Z)(this,a,{writable:!0,value:void 0}),this.form=new l.cw({msg:new l.NI("",{nonNullable:!0,validators:l.kI.required})}),this.rowsCountControl=new l.NI(1e6,{nonNullable:!0}),(0,k.Z)(this,i,(0,E.Cu)()),(0,k.Z)(this,a,(0,r.f3M)(r.R0b)),this.generatedExcelFile=null,this.loading=!1}runInAngularContext(e="runInAngularContext"){this.loading=!0;const n=this.rowsCountControl.value,s=[];for(let C=0;C<n;C++)s.push({userId:m.We.string.uuid(),username:m.We.internet.userName(),email:m.We.internet.email(),avatar:m.We.image.avatar(),password:m.We.internet.password(),birthdate:m.We.date.birthdate(),registeredAt:m.We.date.past()});const F=u.P6.json_to_sheet(s),x=u.P6.book_new();u.P6.book_append_sheet(x,F,"Sheet1"),this.generatedExcelFile=(0,u.cW)(x,{type:"buffer",compression:!0}),console.log(`[${e}]`,"ArrayBuffer result:",this.generatedExcelFile),console.log(`[${e}]`,`ArrayBuffer size in mb ~ ${this.bytesToSize(this.generatedExcelFile.byteLength)}`),this.loading=!1}runInJSContext(){(0,v.Z)(this,a).runOutsideAngular(()=>this.runInAngularContext("runInJSContext"))}runInWorkerContext(){console.log("call runInWorkerContext"),this.loading=!0,(0,v.Z)(this,i).generateDatas(this.rowsCountControl.value).then(e=>{console.log("[runInWorkerContext]","ArrayBuffer result:",e),console.log("[runInWorkerContext]",`ArrayBuffer size in mb ~ ${this.bytesToSize(e.byteLength)}`),this.generatedExcelFile=e,this.loading=!1})}onClickDownloadFile(){const e=new Blob([this.generatedExcelFile],{type:"application/vnd.ms-excel;charset=utf-8"}),n=document.createElement("a");n.href=URL.createObjectURL(e),n.download="generated.xlsx",document.body.appendChild(n),n.click()}bytesToSize(e){const n=["Bytes","KB","MB","GB","TB"];if(0==e)return"n/a";let s=parseInt(`${Math.floor(Math.log(e)/Math.log(1024))}`);return 0==s?e+" "+n[s]:(e/Math.pow(1024,s)).toFixed(1)+" "+n[s]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-excel-writer-with-comlink-worker-demo"]],standalone:!0,features:[r.jDz],decls:24,vars:3,consts:[[1,"center-center","wrapper"],[2,"margin-bottom","0.5rem"],["max","1000000","min","0","step","50000","discrete","true","showTickMarks","true",1,"w-100",2,"max-width","-webkit-fill-available"],["matSliderThumb","",3,"formControl"],[2,"display","flex","flex-direction","column","gap","0.5rem"],["mat-raised-button","","type","button","color","primary",3,"click"],["mat-raised-button","","type","button","color","primary",3,"disabled","click"],[2,"display","flex","gap","0.2rem","align-items","center"],["color","accent","mode","indeterminate","diameter","24",4,"ngIf"],["color","accent","mode","indeterminate","diameter","24"]],template:function(e,n){1&e&&(r.TgZ(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),r._uU(4,"Generate excel with fake data"),r.qZA()(),r.TgZ(5,"mat-card-content")(6,"div",1)(7,"div")(8,"b"),r._uU(9,"Generate rows count"),r.qZA()(),r.TgZ(10,"mat-slider",2),r._UZ(11,"input",3),r.qZA()(),r.TgZ(12,"div",4)(13,"button",5),r.NdJ("click",function(){return n.runInAngularContext()}),r._uU(14," Run in Angular context(freeze browser when rows ~ 1M)"),r.qZA(),r.TgZ(15,"button",5),r.NdJ("click",function(){return n.runInJSContext()}),r._uU(16," Run in JS context(maybe freeze browser when rows ~ 1M)"),r.qZA(),r.TgZ(17,"button",5),r.NdJ("click",function(){return n.runInWorkerContext()}),r._uU(18," Run in Worker context( :) ) "),r.qZA(),r.TgZ(19,"button",6),r.NdJ("click",function(){return n.onClickDownloadFile()}),r.TgZ(20,"div",7)(21,"div"),r._uU(22,"Download generated file"),r.qZA(),r.YNc(23,D,1,0,"mat-progress-spinner",8),r.qZA()()()()()()),2&e&&(r.xp6(11),r.Q6J("formControl",n.rowsCountControl),r.xp6(8),r.Q6J("disabled",null===n.generatedExcelFile),r.xp6(4),r.Q6J("ngIf",n.loading))},dependencies:[p.ez,p.O5,l.u5,l.Fj,l.JJ,y.ot,y.lW,d.QW,d.a8,d.dn,d.dk,d.n5,W.lN,T.c,g.KP,g.pH,g.$5,l.UX,l.oH,z,O],styles:["[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:inline-flex;gap:2rem}[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:inline-block;width:600px}[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),t})()}}]);